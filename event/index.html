<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Paintedd | Event Horizon</title>
    
    <link rel="icon" href="../pallet/img/logo-circular.png" type="image/png">
    
    <script src="https://kit.fontawesome.com/29c25c094f.js" crossorigin="anonymous"></script>
    
    <style>
        /* --- 1. THE VOID --- */
        :root {
            --bg: #050505;
            --text: #ffffff;
            --ease: cubic-bezier(0.23, 1, 0.32, 1);
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg);
            /* Noise Texture */
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
            color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0; height: 100vh; overflow: hidden;
            display: flex; flex-direction: column;
            user-select: none; position: relative;
        }

        /* --- 2. PRISM LAYER --- */
        .prism-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; overflow: hidden; }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.15; transition: transform 0.1s linear; mix-blend-mode: screen; }
        .orb.red { width: 400px; height: 400px; background: #ff0055; top: 50%; left: 50%; margin: -200px 0 0 -200px; }
        .orb.cyan { width: 350px; height: 350px; background: #00ccff; top: 50%; left: 50%; margin: -175px 0 0 -175px; }
        .orb.purple { width: 300px; height: 300px; background: #8800ff; top: 50%; left: 50%; margin: -150px 0 0 -150px; }

        /* --- 3. UI ELEMENTS --- */
        .breadcrumbs { position: fixed; top: 30px; left: 30px; z-index: 20; font-family: monospace; font-size: 0.75rem; color: #aaa; letter-spacing: 1px; pointer-events: auto; text-shadow: 0 2px 4px rgba(0,0,0,0.8); }
        .breadcrumbs a { color: #aaa; text-decoration: none; } .breadcrumbs a:hover { color: #fff; }

        header { padding: 30px; position: fixed; top: 0; right: 0; z-index: 10; pointer-events: none; }
        .meta-status { font-family: monospace; font-size: 0.7rem; color: #fff; background: rgba(0,0,0,0.6); border: 1px solid rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 4px; backdrop-filter: blur(10px); display: flex; align-items: center; gap: 8px; }
        .live-dot { width: 6px; height: 6px; background: #00ff00; border-radius: 50%; box-shadow: 0 0 5px #00ff00; }

        /* --- 4. DECK --- */
        main { position: relative; z-index: 5; flex: 1; width: 100%; display: flex; align-items: center; overflow-x: auto; overflow-y: hidden; scroll-snap-type: x mandatory; padding: 0 20px; cursor: grab; scrollbar-width: none; }
        main::-webkit-scrollbar { display: none; }
        main.is-dragging { cursor: grabbing; scroll-snap-type: none; }
        main.is-dragging .enter-btn, main.is-dragging .social-link { pointer-events: none; }
        .spacer { min-width: 50vw; flex-shrink: 0; } 
        @media (max-width: 600px) { .spacer { min-width: 15vw; } }

        /* --- 5. FULL ART CARD --- */
        .portal { scroll-snap-align: center; flex-shrink: 0; width: 85vw; max-width: 400px; height: 65vh; max-height: 600px; margin: 0 20px; perspective: 1500px; position: relative; cursor: default; }

        .glass {
            width: 100%; height: 100%;
            background-color: rgba(20, 20, 20, 0.6);
            background-size: cover; background-position: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            display: flex; flex-direction: column; justify-content: space-between;
            padding: 20px; /* Tighter padding for mobile */
            position: relative; overflow: hidden;
            box-shadow: 0 30px 60px -15px rgba(0,0,0,0.8);
            transition: transform 0.6s var(--ease), opacity 0.6s var(--ease);
        }

        /* Subtle global scrim for atmosphere */
        .glass::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(to bottom, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0) 50%, rgba(0,0,0,0.6) 100%); pointer-events: none; z-index: 1; }
        
        /* Noise Overlay */
        .glass::before { content: ''; position: absolute; top:0; left:0; width:100%; height:100%; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E"); opacity: 0.5; pointer-events: none; mix-blend-mode: overlay; z-index: 1; }

        /* --- 6. INFO SLABS (The Legibility Fix) --- */
        .info-slab {
            background: rgba(0, 0, 0, 0.65); /* Dark semi-transparent */
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            position: relative; z-index: 5; /* Above scrim */
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h2 { font-size: 1.8rem; line-height: 1; margin: 0 0 10px 0; font-weight: 800; letter-spacing: -0.5px; color: #fff; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .details { font-family: monospace; font-size: 0.8rem; color: #ddd; line-height: 1.6; font-weight: 500; }
        .details i { width: 25px; text-align: center; margin-right: 5px; color: var(--tint); filter: drop-shadow(0 0 5px var(--tint)); }

        .top-content { margin-top: 10px; }
        .bottom-content { margin-bottom: 25px; /* Room for reactor */ }

        /* --- 7. SWIPE REACTOR --- */
        .swipe-reactor {
            position: absolute; bottom: -50px; left: 50%; transform: translateX(-50%);
            width: 150px; height: 80px;
            background: radial-gradient(circle at 50% 0%, var(--tint) 0%, transparent 70%);
            border-radius: 50% 50% 0 0;
            opacity: 0; pointer-events: none; z-index: 3;
            transition: opacity 0.3s;
            filter: blur(20px);
        }
        
        .swipe-hint {
            position: absolute; bottom: 15px; width: 100%; text-align: center;
            font-family: monospace; font-size: 0.7rem; letter-spacing: 2px;
            color: #fff; text-transform: uppercase;
            opacity: 0; z-index: 4; pointer-events: none;
            text-shadow: 0 0 10px var(--tint);
        }
        
        /* Animation for Active/Upcoming */
        .portal[data-status="active"] .swipe-reactor,
        .portal[data-status="upcoming"] .swipe-reactor { opacity: 0.5; bottom: -40px; animation: reactorPulse 3s infinite ease-in-out; }
        .portal[data-status="active"] .swipe-hint,
        .portal[data-status="upcoming"] .swipe-hint { opacity: 0.8; animation: hintBounce 2s infinite; }

        @keyframes reactorPulse { 0%, 100% { opacity: 0.3; transform: translateX(-50%) scale(1); } 50% { opacity: 0.6; transform: translateX(-50%) scale(1.2); } }
        @keyframes hintBounce { 0%, 100% { transform: translateY(0); opacity: 0.5; } 50% { transform: translateY(-5px); opacity: 1; } }

        /* --- 8. BUTTONS --- */
        .satellite-row { display: flex; gap: 15px; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.2); justify-content: center; }
        .social-link { color: #ccc; font-size: 1.2rem; transition: all 0.2s; display: flex; align-items: center; justify-content: center; text-decoration: none; }
        .social-link:hover { color: var(--tint); transform: scale(1.1); text-shadow: 0 0 10px var(--tint); }

        .enter-btn {
            display: block; width: 100%; padding: 14px;
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
            color: #fff; text-decoration: none; text-align: center;
            font-family: monospace; font-weight: 700; letter-spacing: 2px;
            font-size: 0.85rem; border-radius: 12px; cursor: pointer;
            transition: all 0.2s ease; text-transform: uppercase;
        }
        .enter-btn:hover { background: var(--tint); color: #000; border-color: var(--tint); box-shadow: 0 0 20px var(--tint); }
        .enter-btn:active { transform: scale(0.98); }

        /* --- 9. STATUS VARIANTS --- */
        
        /* ACTIVE */
        .portal[data-status="active"] .glass { border-color: rgba(255, 255, 255, 0.4); }

        /* UPCOMING (Hype) */
        .portal[data-status="upcoming"] .glass { border: 2px solid var(--tint); animation: glassPulse 3s infinite ease-in-out; }
        .portal[data-status="upcoming"] .enter-btn { background: rgba(0,0,0,0.5); border: 1px solid var(--tint); box-shadow: 0 0 15px rgba(0,0,0,0.5); }
        .portal[data-status="upcoming"] .enter-btn:hover { background: var(--tint); color: #000; box-shadow: 0 0 30px var(--tint); }

        /* PLANNED (Locked) */
        .portal[data-status="planned"] { opacity: 0.8; }
        .portal[data-status="planned"] .glass { border: 1px dashed rgba(255,255,255,0.3); filter: grayscale(0.8); }
        .portal[data-status="planned"] .enter-btn { opacity: 0.5; cursor: not-allowed; pointer-events: none; border-style: dashed; }

        /* ARCHIVED */
        .portal[data-status="archived"] { opacity: 0.5; filter: grayscale(1); }

        @keyframes glassPulse { 0%, 100% { box-shadow: 0 0 20px rgba(0,0,0,0.5), inset 0 0 0px var(--tint); border-color: rgba(255,255,255,0.3); } 50% { box-shadow: 0 0 40px rgba(0,0,0,0.5), inset 0 0 20px var(--tint); border-color: var(--tint); } }

        /* --- 10. UTILS --- */
        .loader { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #444; letter-spacing: 3px; font-size: 0.8rem; }
    </style>
</head>
<body>

    <div class="prism-layer" id="prism">
        <div class="orb red"></div>
        <div class="orb cyan"></div>
        <div class="orb purple"></div>
    </div>

    <nav class="breadcrumbs">
        <a href="../index.html">HOME</a> <span>/</span> EVENT LOG
    </nav>

    <header>
        <div class="meta-status" id="connection-status">
            <div class="live-dot" id="live-dot"></div> <span id="status-text">SCANNING</span>
        </div>
    </header>

    <main id="deck">
        <div class="loader">INITIALIZING PRISM...</div>
    </main>

    <script>
        const EVENTS_URL = '../pallet/data/events.json';
        const DECK = document.getElementById('deck');
        const STATUS_TEXT = document.getElementById('status-text');
        const LIVE_DOT = document.getElementById('live-dot');

        async function init() {
            try {
                const res = await fetch(EVENTS_URL);
                if(!res.ok) throw new Error("Signal Lost");
                let events = await res.json();
                
                // Sanitize Data
                events = events.map(ev => {
                    if(ev.status === 'upcomming') ev.status = 'upcoming';
                    return ev;
                });

                // Rank: Active -> Upcoming -> Planned -> Archived
                const rank = { 'active': 1, 'upcoming': 2, 'planned': 3, 'archived': 4 };
                events.sort((a,b) => (rank[a.status]||99) - (rank[b.status]||99));

                DECK.innerHTML = '<div class="spacer"></div>';
                let activeCount = 0;

                events.forEach(ev => {
                    if(ev.status === 'active' || ev.status === 'upcoming') activeCount++;
                    
                    const href = `${ev.folder}/index.html`;
                    let btnText = "INITIALIZE";
                    
                    // Logic Gates
                    if(ev.status === 'upcoming') { btnText = "INCOMING"; } // Clickable
                    else if(ev.status === 'planned') { btnText = "LOCKED"; } // Not Clickable
                    else if(ev.status === 'archived') { btnText = "ACCESS LOGS"; }

                    // Satellite Links
                    let socialHTML = '';
                    if (ev.links) {
                        socialHTML = '<div class="satellite-row">';
                        const iconMap = {
                            'website': 'fa-globe', 'instagram': 'fa-instagram', 'facebook': 'fa-facebook',
                            'twitter': 'fa-x-twitter', 'tiktok': 'fa-tiktok', 'youtube': 'fa-youtube'
                        };
                        for (const [key, url] of Object.entries(ev.links)) {
                            const iconClass = iconMap[key.toLowerCase()] || 'fa-link';
                            socialHTML += `<a href="${url}" target="_blank" rel="noopener" class="social-link" title="${key}"><i class="fab ${iconClass}"></i></a>`;
                        }
                        socialHTML += '</div>';
                    }

                    const card = document.createElement('div');
                    card.className = 'portal';
                    card.dataset.status = ev.status;

                    const tint = ev.color || '#fff';
                    const bgUrl = ev.img || ev.image; 
                    const bgStyle = bgUrl ? `background: url('${bgUrl}') no-repeat center center / cover;` : '';

                    card.innerHTML = `
                        <div class="glass" style="--tint: ${tint}; ${bgStyle}">
                            
                            <div class="top-content">
                                <div class="info-slab">
                                    <h2 style="color:${tint}">${ev.name}</h2>
                                    <div class="details">
                                        <div><i class="fas fa-map-marker-alt"></i> ${ev.location}</div>
                                        <div><i class="far fa-calendar"></i> ${ev.dates}</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bottom-content">
                                <div class="info-slab" style="margin-bottom:0; padding:15px;">
                                    <div style="font-size:0.65rem; text-transform:uppercase; letter-spacing:1px; opacity:0.6; text-align:center; margin-bottom:10px;">${ev.status} PROTOCOL</div>
                                    ${socialHTML}
                                    <a href="${href}" class="enter-btn">${btnText}</a>
                                </div>
                            </div>

                            <div class="swipe-reactor"></div>
                            <div class="swipe-hint"><i class="fas fa-chevron-up"></i> SWIPE UP</div>
                        </div>
                    `;

                    // --- SWIPE GESTURE LOGIC ---
                    if (ev.status === 'active' || ev.status === 'upcoming') {
                        let touchStartY = 0;
                        card.addEventListener('touchstart', (e) => {
                            touchStartY = e.touches[0].clientY;
                        }, {passive: true});

                        card.addEventListener('touchend', (e) => {
                            const touchEndY = e.changedTouches[0].clientY;
                            const diff = touchStartY - touchEndY;
                            
                            // Threshold: 50px swipe up
                            if (diff > 50) { 
                                // Trigger vibration if supported
                                if(navigator.vibrate) navigator.vibrate(50);
                                window.location.href = href;
                            }
                        });
                    }

                    DECK.appendChild(card);
                });

                DECK.innerHTML += '<div class="spacer"></div>';
                
                if(activeCount > 0) {
                    STATUS_TEXT.textContent = `${activeCount} ACTIVE`;
                    LIVE_DOT.style.background = '#00ff00';
                    LIVE_DOT.style.boxShadow = '0 0 8px #00ff00';
                } else {
                    STATUS_TEXT.textContent = "ARCHIVE";
                    LIVE_DOT.style.background = '#666';
                    LIVE_DOT.style.boxShadow = 'none';
                }

            } catch (err) {
                console.error(err);
                DECK.innerHTML = `<div class="loader" style="color:#ff4444">LINK FAILURE</div>`;
            }
        }

        // --- PHYSICS ENGINE ---
        let isDown = false;
        let startX;
        let scrollLeft;
        let isDragging = false; 

        DECK.addEventListener('wheel', (e) => {
            if (e.deltaY !== 0) DECK.scrollLeft += e.deltaY;
        });

        DECK.addEventListener('mousedown', (e) => {
            isDown = true;
            isDragging = false; 
            startX = e.pageX - DECK.offsetLeft;
            scrollLeft = DECK.scrollLeft;
        });

        DECK.addEventListener('mouseleave', () => {
            isDown = false;
            DECK.classList.remove('is-dragging');
        });

        DECK.addEventListener('mouseup', () => {
            isDown = false;
            DECK.classList.remove('is-dragging');
        });

        DECK.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            e.preventDefault();
            
            const x = e.pageX - DECK.offsetLeft;
            const walk = (x - startX) * 1.0; 
            
            if (Math.abs(walk) > 5) {
                if (!isDragging) {
                    isDragging = true;
                    DECK.classList.add('is-dragging'); 
                }
            }
            DECK.scrollLeft = scrollLeft - walk;
        });

        // --- PRISM ENGINE ---
        document.addEventListener('mousemove', (e) => {
            const x = e.clientX / window.innerWidth;
            const y = e.clientY / window.innerHeight;
            const red = document.querySelector('.orb.red');
            const cyan = document.querySelector('.orb.cyan');
            const purple = document.querySelector('.orb.purple');
            
            if(red) red.style.transform = `translate(${x * 30}px, ${y * 30}px)`;
            if(cyan) cyan.style.transform = `translate(${x * -40}px, ${y * -40}px)`;
            if(purple) purple.style.transform = `translate(${x * 20}px, ${y * -50}px)`;
        });

        init();
    </script>
</body>
</html>