<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Paintedd | The Archive</title>
    
    <link rel="preload" as="image" href="/pallet/img/logo-circular.png">
    <link rel="icon" href="/pallet/img/logo-circular.png" type="image/png">
    
    <script src="https://kit.fontawesome.com/29c25c094f.js" crossorigin="anonymous"></script>
    
    <style>
        :root {
            --bg: #050505;
            --text: #ffffff;
            
            /* TIER PALETTE */
            --c-green: #00ff9d;
            --c-blue: #00a8ff;
            --c-purple: #bd00ff;
            --c-gold: #ffd700;
            --c-void: #333;
            
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --card-radius: 12px;
            
            /* PHYSICS ENGINE: Fast Up (0.3s), Slow Down (0.6s) */
            --hover-enter: cubic-bezier(0.2, 0.8, 0.2, 1);
            --hover-exit: cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg);
            background: radial-gradient(circle at 50% 0%, #151520 0%, #050505 100%);
            color: var(--text);
            font-family: "Segoe UI", Tahoma, sans-serif;
            margin: 0; min-height: 100vh; overflow-x: hidden;
            overscroll-behavior-y: none;
        }

        /* --- HEADER --- */
        .gallery-header {
            position: fixed; top: 0; left: 0; right: 0; z-index: 50;
            padding: 20px 30px;
            display: flex; justify-content: space-between; align-items: center;
            background: linear-gradient(to bottom, rgba(5,5,5,0.95) 0%, rgba(5,5,5,0) 100%);
            pointer-events: none;
        }

        .header-left, .header-right { pointer-events: auto; display: flex; gap: 15px; align-items: center; }

        .nav-btn {
            width: 45px; height: 45px; border-radius: 50%;
            background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border);
            backdrop-filter: blur(10px); color: #fff;
            display: flex; align-items: center; justify-content: center;
            text-decoration: none; transition: 0.3s ease;
        }
        .nav-btn:hover { background: rgba(255,255,255,0.15); transform: scale(1.1); border-color: #fff; }

        .resonance-pill {
            background: rgba(0, 0, 0, 0.6); border: 1px solid var(--glass-border);
            backdrop-filter: blur(10px); padding: 8px 16px; border-radius: 30px;
            font-size: 0.9rem; font-weight: 600; letter-spacing: 1px;
            display: flex; gap: 10px; align-items: center; pointer-events: auto;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        .res-val { font-variant-numeric: tabular-nums; font-family: monospace; }
        
        /* --- STAGE --- */
        #gallery-stage {
            /* Removed excessive top padding since we deleted the top divider */
            padding: 100px 20px 50px;
            max-width: 1600px; margin: 0 auto;
            min-height: 100vh;
        }

        /* --- DIVIDER (Only for new chunks) --- */
        .chunk-divider {
            display: flex; align-items: center; justify-content: center;
            margin: 60px 0 30px; opacity: 0; animation: fadeIn 1s forwards;
        }
        .div-line { height: 1px; width: 100px; background: linear-gradient(90deg, transparent, currentColor, transparent); opacity: 0.5; }
        .div-node { width: 8px; height: 8px; border-radius: 50%; background: currentColor; margin: 0 15px; box-shadow: 0 0 10px currentColor; }
        @keyframes fadeIn { to { opacity: 1; } }

        /* --- MASONRY --- */
        .masonry-row {
            display: flex; gap: 20px; width: 100%; align-items: flex-start;
        }
        .masonry-col {
            flex: 1; display: flex; flex-direction: column; gap: 20px; min-width: 0;
        }
        @media (max-width: 800px) { .masonry-row { gap: 10px; } .masonry-col { gap: 10px; } }

        /* --- ARTIFACT CARD (Physics Fix) --- */
        .art-card {
            position: relative; background: #111;
            border-radius: var(--card-radius); overflow: hidden;
            cursor: zoom-in; opacity: 0; transform: translateY(40px);
            
            /* Default State (Exit Animation): Slow and Smooth */
            transition: transform 0.6s var(--hover-exit), box-shadow 0.6s var(--hover-exit), border-color 0.6s ease;
            
            border: 1px solid rgba(255,255,255,0.05);
            user-select: none;
        }
        .art-card.visible { animation: floatUp 0.8s ease-out forwards; }
        @keyframes floatUp { to { opacity: 1; transform: translateY(0); } }

        .art-card:hover {
            /* Hover State (Enter Animation): Snappy but Fluid */
            transform: translateY(-8px); 
            z-index: 5;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            transition: transform 0.3s var(--hover-enter), box-shadow 0.3s var(--hover-enter), border-color 0.3s ease;
        }

        /* Glint */
        .art-card::after {
            content: ''; position: absolute; top: 0; left: -150%; width: 100%; height: 100%;
            background: linear-gradient(115deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%);
            transform: skewX(-20deg); pointer-events: none; transition: 0.6s; z-index: 2;
        }
        .art-card:hover::after { left: 150%; transition: 0.8s; }

        .art-card img {
            width: 100%; height: auto; display: block;
            transition: opacity 0.5s; opacity: 0; filter: brightness(0.9);
        }
        .art-card:hover img { filter: brightness(1.1); }
        .art-card img.loaded { opacity: 1; }

        /* Rarity Borders */
        .art-card[data-border="green"] { border-color: rgba(0, 255, 157, 0.3); }
        .art-card[data-border="blue"] { border-color: rgba(0, 168, 255, 0.3); }
        .art-card[data-border="purple"] { border-color: rgba(189, 0, 255, 0.3); box-shadow: 0 0 15px rgba(189,0,255,0.1); }
        .art-card[data-border="gold"] { border-color: rgba(255, 215, 0, 0.4); box-shadow: 0 0 20px rgba(255,215,0,0.15); }

        /* --- THE PRISM (Gacha) --- */
        .prism-gate {
            width: 100%; padding: 80px 0;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.5s;
        }
        .prism-gate.vanish { opacity: 0; pointer-events: none; height: 0; padding: 0; }

        .prism-orb {
            width: 110px; height: 110px; border-radius: 50%;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 0 40px rgba(255,255,255,0.02);
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem; color: rgba(255,255,255,0.5);
            cursor: pointer; transition: all 0.5s ease;
            position: relative; overflow: hidden; backdrop-filter: blur(5px);
        }
        
        .prism-orb:hover { transform: scale(1.1); border-color: #fff; color: #fff; box-shadow: 0 0 60px rgba(255,255,255,0.15); }
        .prism-orb:active { transform: scale(0.95); }

        /* SPIN FIX: Rotates the whole orb */
        .prism-orb.rolling { 
            animation: spin 1s linear infinite;
            border-top-color: #fff;
            border-left-color: var(--c-purple);
        }
        /* Counter-rotate icon to keep it upright-ish or just chaotic */
        .prism-orb.rolling i { animation: spinReverse 1s linear infinite; }

        .prism-orb.green { border-color: var(--c-green); box-shadow: 0 0 50px var(--c-green); color: var(--c-green); }
        .prism-orb.blue { border-color: var(--c-blue); box-shadow: 0 0 60px var(--c-blue); color: var(--c-blue); }
        .prism-orb.purple { border-color: var(--c-purple); box-shadow: 0 0 80px var(--c-purple); color: var(--c-purple); }
        .prism-orb.gold { border-color: var(--c-gold); box-shadow: 0 0 100px var(--c-gold); color: var(--c-gold); animation: pulseGold 2s infinite; }

        .prism-text {
            margin-top: 30px; font-family: monospace; font-weight: 700; 
            letter-spacing: 4px; color: rgba(255,255,255,0.3); font-size: 0.8rem;
            transition: 0.3s;
        }
        .prism-orb:hover + .prism-text { color: #fff; opacity: 1; }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes spinReverse { 0% { transform: rotate(0deg); } 100% { transform: rotate(-360deg); } }
        @keyframes pulseGold { 0% { box-shadow: 0 0 50px var(--c-gold); } 50% { box-shadow: 0 0 100px var(--c-gold); } 100% { box-shadow: 0 0 50px var(--c-gold); } }

        /* --- THEATER (Lightbox) --- */
        .theater {
            position: fixed; inset: 0; z-index: 1000;
            background: rgba(0,0,0,0.96); backdrop-filter: blur(20px);
            opacity: 0; pointer-events: none; transition: opacity 0.4s;
            display: flex;
        }
        .theater.active { opacity: 1; pointer-events: auto; }

        .t-stage {
            flex: 2; position: relative;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden; cursor: grab;
        }
        .t-stage:active { cursor: grabbing; }

        .t-img {
            max-width: 90%; max-height: 90%; object-fit: contain;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            transform-origin: center; will-change: transform;
            user-select: none; -webkit-user-drag: none;
            opacity: 0; transition: opacity 0.3s;
        }
        .t-img.show { opacity: 1; }

        .t-controls {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 10px; z-index: 20;
            background: rgba(40, 40, 40, 0.6);
            backdrop-filter: blur(20px); padding: 10px 15px; border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        .tc-btn {
            width: 45px; height: 45px; border-radius: 50%; border: none;
            background: transparent; color: #eee;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.1rem; cursor: pointer; transition: 0.2s;
        }
        .tc-btn:hover { background: rgba(255,255,255,0.15); color: #fff; transform: translateY(-3px); }

        /* PANEL */
        .t-panel {
            flex: 1; min-width: 350px; max-width: 450px;
            background: rgba(20, 20, 20, 0.95); border-left: 1px solid var(--glass-border);
            padding: 40px; display: flex; flex-direction: column; gap: 20px;
            overflow-y: auto; z-index: 10;
        }
        @media(max-width: 900px) { 
            .theater { flex-direction: column; } 
            .t-panel { 
                width: 100%; max-width: none; 
                height: auto; max-height: 40%; min-height: 200px;
                border-left: none; border-top: 1px solid var(--glass-border); 
                padding: 20px;
            } 
        }

        .t-close {
            position: absolute; top: 20px; right: 20px; z-index: 50;
            width: 45px; height: 45px; border-radius: 50%;
            background: rgba(255,255,255,0.1); color: #fff;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
            transition: 0.2s; backdrop-filter: blur(5px);
        }
        .t-close:hover { background: #d90429; transform: rotate(90deg); }

        .t-meta h1 { margin: 0; font-size: 2rem; font-weight: 700; color: #fff; line-height: 1.1; }
        .t-meta p { font-family: monospace; color: var(--c-blue); margin-top: 5px; opacity: 0.8; }
        .t-desc { color: #ccc; line-height: 1.6; font-size: 0.95rem; border-left: 2px solid var(--c-purple); padding-left: 15px; }

        /* WHATSAPP GREEN BUTTON */
        .action-btn {
            width: 100%; padding: 15px; border-radius: 8px;
            /* Official WhatsApp Green */
            background: #25D366; 
            color: #fff; font-weight: 700; letter-spacing: 1px;
            border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;
            transition: transform 0.2s, box-shadow 0.2s; margin-top: auto;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        .action-btn:hover { 
            transform: translateY(-3px); 
            box-shadow: 0 10px 30px rgba(37, 211, 102, 0.4); 
            background: #20bd5a; 
        }

        /* End Card */
        .end-card {
            width: 100%; max-width: 500px; margin: 100px auto; padding: 60px 40px;
            border: 1px solid rgba(255,255,255,0.1); 
            background: linear-gradient(180deg, rgba(20,20,25,0.9), rgba(5,5,5,0.95));
            border-radius: 4px; text-align: center; backdrop-filter: blur(20px);
            animation: floatUp 1s ease;
        }
        .end-score { font-size: 3.5rem; font-weight: 800; color: #fff; line-height: 1; }
        .end-rank { font-size: 1.2rem; color: #ffd700; letter-spacing: 2px; margin-top: 10px; }

    </style>
</head>
<body>

    <header class="gallery-header">
        <div class="header-left">
            <a href="/" class="nav-btn" title="Home"><i class="fas fa-home"></i></a>
        </div>
        <div class="header-right">
            <div class="resonance-pill">
                <span class="res-icon">ðŸŽˆ</span>
                <span class="res-val" id="score-val">0</span>
            </div>
            <a href="/universe/quickview/" class="nav-btn" title="QuickView"><i class="fas fa-search"></i></a>
        </div>
    </header>

    <div id="gallery-stage"></div>

    <div class="theater" id="theater">
        <div class="t-close" id="close-theater"><i class="fas fa-times"></i></div>
        
        <div class="t-stage" id="t-stage">
            <img src="" class="t-img" id="t-img" ondragstart="return false;">
            
            <div class="t-controls">
                <button class="tc-btn" id="btn-prev"><i class="fas fa-chevron-left"></i></button>
                <button class="tc-btn" id="btn-next"><i class="fas fa-chevron-right"></i></button>
                <div class="tc-sep" style="width:1px; height:20px; background:rgba(255,255,255,0.2); margin:0 5px;"></div>
                <button class="tc-btn" id="btn-rotate"><i class="fas fa-rotate-right"></i></button>
            </div>
        </div>
        
        <div class="t-panel">
            <div id="t-status"></div>
            <div class="t-meta">
                <h1 id="t-title"></h1>
                <p id="t-id"></p>
            </div>
            <div class="t-desc" id="t-desc"></div>
            
            <button class="action-btn" id="inquire-btn">
                <i class="fab fa-whatsapp"></i> <span>INQUIRE ARTIST</span>
            </button>
        </div>
    </div>

    <script>
        const ART_URL = '/pallet/data/art.json';
        const STORE_URL = '/pallet/data/store.json';

        const stage = document.getElementById('gallery-stage');
        const scoreVal = document.getElementById('score-val');
        
        // Data
        let allArtworks = [];
        let loadedChunks = []; 
        let storeData = {};
        let loadedCount = 0;
        let userScore = 0; 
        let theaterIndex = -1;

        // Tiers
        const TIERS = [
            { id: 'green',  label: 'COMMON',    color: '#00ff9d', count: 8,  weight: 50 },
            { id: 'blue',   label: 'RARE',      color: '#00a8ff', count: 16, weight: 30 },
            { id: 'purple', label: 'LEGENDARY', color: '#bd00ff', count: 24, weight: 15 },
            { id: 'gold',   label: 'EXOTIC',    color: '#ffd700', count: 40, weight: 5 }
        ];

        // --- INIT ---
        async function init() {
            try {
                const [artRes, storeRes] = await Promise.all([
                    fetch(ART_URL),
                    fetch(STORE_URL).catch(() => ({ ok: false }))
                ]);

                if(!artRes.ok) throw new Error("404");
                const data = await artRes.json();
                allArtworks = Array.isArray(data) ? data : (data.artworks || []);
                
                // Shuffle
                for (let i = allArtworks.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [allArtworks[i], allArtworks[j]] = [allArtworks[j], allArtworks[i]];
                }

                if(storeRes.ok) {
                    const store = await storeRes.json();
                    (store.inventory || []).forEach(i => storeData[i.art_id] = i);
                }

                // Initial Load (Free) - NO DIVIDER
                loadChunk(8, null); 

            } catch(e) {
                console.error(e);
                stage.innerHTML = `<div style="text-align:center; color:#666; margin-top:100px;">ARCHIVE OFFLINE</div>`;
            }
        }

        // --- SCORING ---
        function addScore(amt) {
            userScore += amt;
            scoreVal.textContent = userScore;
        }

        // --- LAYOUT ---
        function createColumns() {
            const row = document.createElement('div');
            row.className = 'masonry-row';
            
            const w = window.innerWidth;
            const cols = w > 1400 ? 4 : (w > 900 ? 3 : 2);
            
            const buckets = [];
            for(let i=0; i<cols; i++) {
                const col = document.createElement('div');
                col.className = 'masonry-col';
                row.appendChild(col);
                buckets.push(col);
            }
            stage.appendChild(row);
            return buckets;
        }

        // --- LOADING LOGIC ---
        function loadChunk(amount, tierData) {
            if(loadedCount >= allArtworks.length) {
                showEndCard();
                return;
            }

            // Divider (Only if tierData is provided, skips on initial load)
            if(tierData) {
                const div = document.createElement('div');
                div.className = 'chunk-divider';
                div.style.color = tierData.color;
                div.innerHTML = `<div class="div-line"></div><div class="div-node"></div><div class="div-line"></div>`;
                stage.appendChild(div);
            }

            const buckets = createColumns();
            const chunk = allArtworks.slice(loadedCount, loadedCount + amount);
            
            chunk.forEach((item, i) => {
                loadedChunks.push(item);
                const globalIdx = loadedChunks.length - 1;

                const imgObj = item.images || {};
                const src = imgObj.thumbnail || imgObj.medium || imgObj.original;
                
                // Visual RNG
                const rand = Math.random();
                let border = '';
                if(rand > 0.95) border = 'gold';
                else if(rand > 0.85) border = 'purple';
                else if(rand > 0.70) border = 'blue';
                else if(rand > 0.50) border = 'green';
                
                const card = document.createElement('div');
                card.className = `art-card`;
                card.style.animationDelay = `${i * 50}ms`;
                if(border) card.dataset.border = border;
                
                const img = document.createElement('img');
                img.loading = 'lazy';
                img.src = src;
                img.onload = () => {
                    img.classList.add('loaded');
                    card.classList.add('visible');
                    addScore(10);
                };

                card.appendChild(img);
                card.onclick = () => openTheater(globalIdx);

                buckets[i % buckets.length].appendChild(card);
            });

            loadedCount += chunk.length;

            if(loadedCount < allArtworks.length) {
                spawnPrism();
            } else {
                showEndCard();
            }
        }

        // --- GACHA (THE PRISM) ---
        function spawnPrism() {
            const gate = document.createElement('div');
            gate.className = 'prism-gate';
            gate.innerHTML = `
                <div class="prism-orb" onclick="rollGacha(this)">
                    <i class="fas fa-fingerprint"></i>
                </div>
                <div class="prism-text">TOUCH TO RESONATE</div>
            `;
            stage.appendChild(gate);
        }

        window.rollGacha = function(orb) {
            if(orb.classList.contains('rolling')) return;
            orb.classList.add('rolling');
            
            const text = orb.nextElementSibling;
            text.innerText = "TUNING...";
            
            // 4 Seconds Roll
            let step = 0;
            const colors = ['green', 'blue', 'purple', 'gold'];
            
            const interval = setInterval(() => {
                orb.className = `prism-orb rolling ${colors[step % 4]}`;
                orb.innerHTML = '<i class="fas fa-circle-notch"></i>';
                step++;
            }, 200); 

            setTimeout(() => {
                clearInterval(interval);
                
                // Result
                let rand = Math.floor(Math.random() * 100);
                let result = TIERS[0];
                let sum = 0;
                for(let t of TIERS) {
                    sum += t.weight;
                    if(rand < sum) { result = t; break; }
                }

                // Show
                orb.className = `prism-orb ${result.id}`;
                orb.innerHTML = result.id === 'gold' ? '<i class="fas fa-star"></i>' : '<i class="fas fa-check"></i>';
                text.innerText = `// ${result.label} UNLOCKED`;
                text.style.color = result.color;
                
                addScore(500); 

                setTimeout(() => {
                    const gate = orb.parentElement;
                    gate.classList.add('vanish');
                    setTimeout(() => {
                        gate.remove();
                        loadChunk(result.count, { color: result.color });
                    }, 500);
                }, 1500);

            }, 4000); // 4 Seconds
        };

        function showEndCard() {
            const card = document.createElement('div');
            card.className = 'end-card';
            card.innerHTML = `
                <div style="font-size:3rem; color:#ffd700; margin-bottom:20px;"><i class="fas fa-crown"></i></div>
                <div class="end-score">${userScore}</div>
                <div style="color:#888; font-family:monospace; letter-spacing:2px;">TOTAL RESONANCE</div>
                <div class="end-rank">ARCHIVE COMPLETE</div>
            `;
            stage.appendChild(card);
        }

        // --- THEATER ENGINE ---
        const theater = document.getElementById('theater');
        const tImg = document.getElementById('t-img');
        const tStage = document.getElementById('t-stage');
        let state = { x:0, y:0, scale:1, rotation:0 };

        function openTheater(index) {
            theaterIndex = index;
            const item = loadedChunks[index];
            if(!item) return;

            // Content Logic (Smart Title)
            const displayTitle = item.title ? item.title : item.id;
            document.getElementById('t-title').textContent = displayTitle;
            document.getElementById('t-id').textContent = item.id;
            document.getElementById('t-desc').textContent = item.description || "";
            
            // Image
            tImg.classList.remove('show');
            tImg.src = item.images.medium || item.images.original;
            tImg.onload = () => tImg.classList.add('show');

            // Reset Transform
            state = { x:0, y:0, scale:1, rotation:0 };
            updateTransform();

            theater.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function updateTransform() {
            tImg.style.transform = `translate(${state.x}px, ${state.y}px) rotate(${state.rotation}deg) scale(${state.scale})`;
        }

        // --- GESTURES & ZOOM ---
        let isDrag = false;
        let startX=0, startY=0, initX=0, initY=0;

        tStage.addEventListener('mousedown', e => {
            if(e.target.closest('.tc-btn')) return;
            isDrag = true;
            startX = e.clientX; startY = e.clientY;
            initX = state.x; initY = state.y;
            tImg.style.transition = 'none';
        });

        window.addEventListener('mousemove', e => {
            if(!isDrag) return;
            e.preventDefault();
            state.x = initX + (e.clientX - startX);
            state.y = initY + (e.clientY - startY);
            updateTransform();
        });

        window.addEventListener('mouseup', () => {
            if(!isDrag) return;
            isDrag = false;
            tImg.style.transition = 'transform 0.3s cubic-bezier(0.2,1,0.3,1)';
            // Snap logic
            if(state.scale === 1) {
                if(state.x < -100) { nextItem(); return; }
                if(state.x > 100) { prevItem(); return; }
                state.x = 0; state.y = 0; updateTransform();
            }
        });

        tStage.addEventListener('wheel', e => {
            e.preventDefault();
            const delta = e.deltaY > 0 ? -0.1 : 0.1;
            state.scale = Math.max(0.5, Math.min(4, state.scale + delta));
            updateTransform();
        });

        // Navigation
        function nextItem() { if(theaterIndex < loadedChunks.length-1) openTheater(theaterIndex+1); }
        function prevItem() { if(theaterIndex > 0) openTheater(theaterIndex-1); }

        document.getElementById('btn-next').onclick = nextItem;
        document.getElementById('btn-prev').onclick = prevItem;
        document.getElementById('close-theater').onclick = () => {
            theater.classList.remove('active');
            document.body.style.overflow = '';
        };
        document.getElementById('btn-rotate').onclick = () => {
            state.rotation += 90; updateTransform();
        };

        document.getElementById('inquire-btn').onclick = () => {
            const item = loadedChunks[theaterIndex];
            if(!item) return;
            const title = item.title || item.id;
            window.open(`https://wa.me/27641417574?text=Hi, inquiring about "${title}" (ID: ${item.id})`, '_blank');
        };

        document.addEventListener('keydown', e => {
            if(!theater.classList.contains('active')) return;
            if(e.key === 'Escape') document.getElementById('close-theater').click();
            if(e.key === 'ArrowRight') nextItem();
            if(e.key === 'ArrowLeft') prevItem();
        });

        init();

    </script>
</body>
</html>